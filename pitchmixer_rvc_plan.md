# PitchMixer with RVC - ì™„ì „ ë¬´ë£Œ ê°œë°œ ê³„íšì„œ
## Antigravity + Hugging Face Spaces ê¸°ë°˜ êµ¬í˜„

---

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

### í”„ë¡œì íŠ¸ëª…: **PitchMixer** ğŸµ
ìŒì•… íŒŒì¼ê³¼ ë³´ì´ìŠ¤ ìƒ˜í”Œì„ ì—…ë¡œë“œí•˜ë©´, RVC AIê°€ ë³´ì´ìŠ¤ë¥¼ ìŒì•…ì˜ ë©œë¡œë””ì— ì™„ë²½í•˜ê²Œ ë§ì¶° ë³€í™˜í•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜

### í•µì‹¬ ê¸°ëŠ¥
1. ğŸ¼ ìŒì•… íŒŒì¼ ì—…ë¡œë“œ (MP3, WAV ë“±)
2. ğŸ¤ ë³´ì´ìŠ¤ ìƒ˜í”Œ ì—…ë¡œë“œ (ì‚¬ìš©ì ëª©ì†Œë¦¬)
3. ğŸ¤– **RVC AIë¡œ ìë™ í”¼ì¹˜ ë§¤ì¹­** 
4. ğŸ” ë³´ì´ìŠ¤ê°€ ì§§ìœ¼ë©´ ìë™ ë°˜ë³µ
5. â–¶ï¸ ê²°ê³¼ ì¬ìƒ ë° ë‹¤ìš´ë¡œë“œ

### ì™œ RVCì¸ê°€?
- âœ… **ì™„ì „ ë¬´ë£Œ** (ì˜¤í”ˆì†ŒìŠ¤)
- âœ… **ìë™ í”¼ì¹˜ ë³´ì¡´**: ìˆ˜ë™ í”¼ì¹˜ ë¶„ì„ ë¶ˆí•„ìš”
- âœ… **ê³ í’ˆì§ˆ ìŒì§ˆ**: ì›ë³¸ ìŒìƒ‰ ìœ ì§€
- âœ… **Hugging Face Spacesì—ì„œ ë¬´ë£Œ í˜¸ìŠ¤íŒ… ê°€ëŠ¥**
- âœ… **ì‹¤ì‹œê°„ ì²˜ë¦¬ ê°€ëŠ¥** (ì§€ì—°ì‹œê°„ 90-170ms)

---

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Antigravity Frontend                   â”‚
â”‚                    (React + Tailwind)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Hugging Face Spaces API                     â”‚
â”‚         (RVC V2 - ë¬´ë£Œ ìŒì„± ë³€í™˜ ì„œë¹„ìŠ¤)                â”‚
â”‚   https://huggingface.co/spaces/Clebersla/RVC_V2...     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ì²˜ë¦¬ ê²°ê³¼ ë°˜í™˜                         â”‚
â”‚            (ë³€í™˜ëœ ì˜¤ë””ì˜¤ íŒŒì¼)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° í”Œë¡œìš°

```
[ìŒì•… ì—…ë¡œë“œ] â†’ [ë³´ì»¬ ë¶„ë¦¬ (ì„ íƒ)] â†’ [RVC í”¼ì¹˜ ì¶”ì¶œ]
                                            â†“
[ë³´ì´ìŠ¤ ì—…ë¡œë“œ] â†’ [RVC ë³€í™˜ API í˜¸ì¶œ] â†’ [í”¼ì¹˜ ë§¤ì¹­ ì™„ë£Œ]
                                            â†“
                                  [ë°˜ë³µ ì²˜ë¦¬] â†’ [ìµœì¢… ì˜¤ë””ì˜¤]
                                            â†“
                                  [ì¬ìƒ / ë‹¤ìš´ë¡œë“œ]
```

---

## ğŸ“Š ê¸°ìˆ  ìŠ¤íƒ & ë¹„ìš©

### Frontend (Antigravity)
| ê¸°ìˆ  | ìš©ë„ | ë¹„ìš© |
|-----|------|------|
| React | UI í”„ë ˆì„ì›Œí¬ | **ë¬´ë£Œ** |
| Tailwind CSS | ìŠ¤íƒ€ì¼ë§ | **ë¬´ë£Œ** |
| Tone.js | ì˜¤ë””ì˜¤ ì¬ìƒ/ë¯¹ì‹± | **ë¬´ë£Œ** |
| Axios | API í˜¸ì¶œ | **ë¬´ë£Œ** |

### Backend (Hugging Face Spaces)
| ì„œë¹„ìŠ¤ | ìš©ë„ | ë¹„ìš© |
|-------|------|------|
| **RVC V2 Space** | ìŒì„± ë³€í™˜ | **ë¬´ë£Œ (CPU)** |
| Hugging Face API | ëª¨ë¸ í˜¸ìŠ¤íŒ… | **ë¬´ë£Œ** |
| Gradio Client | API ì¸í„°í˜ì´ìŠ¤ | **ë¬´ë£Œ** |

### ë°°í¬
| í”Œë«í¼ | ìš©ë„ | ë¹„ìš© |
|-------|------|------|
| Claude Antigravity | í”„ë¡ íŠ¸ì—”ë“œ í˜¸ìŠ¤íŒ… | **ë¬´ë£Œ** |
| GitHub Pages (ì„ íƒ) | í¼ë¸”ë¦­ ë°°í¬ | **ë¬´ë£Œ** |

**ğŸ’° ì´ ë¹„ìš©: $0 (ì™„ì „ ë¬´ë£Œ!)**

---

## ğŸ”§ ìƒì„¸ êµ¬í˜„ ê³„íš

## PHASE 1: Hugging Face RVC API ì—°ë™ (2ì‹œê°„)

### STEP 1.1: RVC API ì´í•´í•˜ê¸° (30ë¶„)

#### ì‚¬ìš© ê°€ëŠ¥í•œ ë¬´ë£Œ RVC Spaces

| Space ì´ë¦„ | URL | íŠ¹ì§• | ì¶”ì²œë„ |
|-----------|-----|------|--------|
| **RVC V2** | `Clebersla/RVC_V2_Huggingface_Version` | ê°€ì¥ ì•ˆì •ì , ë‹¤ì–‘í•œ ëª¨ë¸ | â­â­â­â­â­ |
| **RVCâš¡ZERO** | `r3gm/rvc_zero` | ë¹ ë¥¸ ì²˜ë¦¬, ê°„ë‹¨í•œ ì¸í„°í˜ì´ìŠ¤ | â­â­â­â­ |
| **RVC Inference HF** | `r3gm/RVC_HFv2` | ì˜¤ë””ì˜¤ ë¯¹ì‹± ê¸°ëŠ¥ í¬í•¨ | â­â­â­â­ |

**ìµœì¢… ì„ íƒ: RVC V2** (ê°€ì¥ ë§ì€ ê¸°ëŠ¥, ì»¤ë®¤ë‹ˆí‹° ì§€ì›)

#### RVC API ì‘ë™ ì›ë¦¬

```javascript
// Gradio Clientë¡œ API í˜¸ì¶œ
import { client } from "@gradio/client";

const app = await client("Clebersla/RVC_V2_Huggingface_Version");

const result = await app.predict("/run", {
  audio_path: audioFile,        // ì…ë ¥ ì˜¤ë””ì˜¤
  model_name: "default_model",  // RVC ëª¨ë¸
  pitch: 0,                     // í”¼ì¹˜ ì¡°ì • (-12 ~ +12)
  index_rate: 0.5,              // ì¸ë±ìŠ¤ ì˜í–¥ë„
  filter_radius: 3,             // ì¤‘ì•™ê°’ í•„í„°
  rms_mix_rate: 0.25,           // ë³¼ë¥¨ ë¯¹ì‹±
  protect: 0.33                 // ë¬´ì„±ìŒ ë³´í˜¸
});

// result.data = ë³€í™˜ëœ ì˜¤ë””ì˜¤ URL
```

### STEP 1.2: Gradio Client ì„¤ì • (30ë¶„)

#### ë¸Œë¼ìš°ì €ì—ì„œ Gradio ì‚¬ìš©í•˜ê¸°

```javascript
// utils/rvcClient.js

/**
 * RVC API í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”
 */
export class RVCClient {
  constructor() {
    this.spaceUrl = "Clebersla/RVC_V2_Huggingface_Version";
    this.client = null;
  }

  async initialize() {
    if (this.client) return;
    
    try {
      // Gradio Client ë™ì  ë¡œë”©
      const { client } = await import("@gradio/client");
      this.client = await client(this.spaceUrl);
      console.log('âœ“ RVC Client ì´ˆê¸°í™” ì™„ë£Œ');
    } catch (error) {
      throw new Error(`RVC Client ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`);
    }
  }

  /**
   * ìŒì„± ë³€í™˜ ì‹¤í–‰
   * @param {File} audioFile - ì…ë ¥ ì˜¤ë””ì˜¤ íŒŒì¼
   * @param {Object} options - ë³€í™˜ ì˜µì…˜
   * @returns {Promise<string>} ë³€í™˜ëœ ì˜¤ë””ì˜¤ URL
   */
  async convertVoice(audioFile, options = {}) {
    await this.initialize();

    const {
      modelName = "default_model",
      pitch = 0,
      indexRate = 0.5,
      filterRadius = 3,
      rmsMixRate = 0.25,
      protect = 0.33
    } = options;

    try {
      const result = await this.client.predict("/run", {
        audio_path: audioFile,
        model_name: modelName,
        pitch: pitch,
        index_rate: indexRate,
        filter_radius: filterRadius,
        rms_mix_rate: rmsMixRate,
        protect: protect
      });

      // ê²°ê³¼ URL ë°˜í™˜
      return result.data[0];
      
    } catch (error) {
      throw new Error(`RVC ë³€í™˜ ì‹¤íŒ¨: ${error.message}`);
    }
  }

  /**
   * ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
   */
  async getAvailableModels() {
    await this.initialize();
    
    try {
      const result = await this.client.predict("/get_models", {});
      return result.data;
    } catch (error) {
      console.warn('ëª¨ë¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
      return ["default_model"];
    }
  }
}
```

#### Gradio Client ëŒ€ì•ˆ: ì§ì ‘ API í˜¸ì¶œ

**Gradioê°€ ì‘ë™í•˜ì§€ ì•Šì„ ê²½ìš°**:

```javascript
// utils/rvcClient.js (REST API ë²„ì „)

export class RVCClient {
  constructor() {
    this.apiUrl = "https://clebersla-rvc-v2-huggingface-version.hf.space";
  }

  async convertVoice(audioFile, options = {}) {
    const formData = new FormData();
    formData.append('audio_path', audioFile);
    formData.append('pitch', options.pitch || 0);
    formData.append('index_rate', options.indexRate || 0.5);

    try {
      const response = await fetch(`${this.apiUrl}/api/predict`, {
        method: 'POST',
        body: formData
      });

      if (!response.ok) {
        throw new Error(`API ì˜¤ë¥˜: ${response.status}`);
      }

      const result = await response.json();
      return result.data[0]; // ì˜¤ë””ì˜¤ URL
      
    } catch (error) {
      throw new Error(`RVC API í˜¸ì¶œ ì‹¤íŒ¨: ${error.message}`);
    }
  }
}
```

### STEP 1.3: í…ŒìŠ¤íŠ¸ (1ì‹œê°„)

```javascript
// test/rvcTest.js

import { RVCClient } from '../utils/rvcClient';

async function testRVCConnection() {
  console.log('ğŸ§ª RVC ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
  
  const client = new RVCClient();
  
  // 1. ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
  try {
    await client.initialize();
    console.log('âœ… ì´ˆê¸°í™” ì„±ê³µ');
  } catch (error) {
    console.error('âŒ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
    return;
  }

  // 2. ëª¨ë¸ ëª©ë¡ í…ŒìŠ¤íŠ¸
  try {
    const models = await client.getAvailableModels();
    console.log('âœ… ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë¸:', models);
  } catch (error) {
    console.warn('âš ï¸ ëª¨ë¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
  }

  // 3. ìŒì„± ë³€í™˜ í…ŒìŠ¤íŠ¸ (ìƒ˜í”Œ íŒŒì¼)
  const testAudio = new File(
    [new Blob()], 
    'test.wav', 
    { type: 'audio/wav' }
  );
  
  try {
    const result = await client.convertVoice(testAudio, {
      pitch: 0,
      indexRate: 0.5
    });
    console.log('âœ… ë³€í™˜ ì„±ê³µ:', result);
  } catch (error) {
    console.error('âŒ ë³€í™˜ ì‹¤íŒ¨:', error);
  }
}

// ì‹¤í–‰
testRVCConnection();
```

---

## PHASE 2: í”¼ì¹˜ ë§¤ì¹­ ì—”ì§„ ê°œë°œ (2ì‹œê°„)

### STEP 2.1: ìŒì•… í”¼ì¹˜ ë¶„ì„ (1ì‹œê°„)

#### RVCëŠ” ìë™ìœ¼ë¡œ í”¼ì¹˜ë¥¼ ê°ì§€í•˜ì§€ë§Œ, ìŒì•… ë©œë¡œë”” ì¶”ì¶œì€ í•„ìš”

```javascript
// engines/MusicAnalyzer.js

import Essentia from 'essentia.js';

export class MusicAnalyzer {
  constructor() {
    this.essentia = null;
  }

  async initialize() {
    if (!this.essentia) {
      this.essentia = new Essentia(EssentiaWASM);
      await this.essentia.initialize();
    }
  }

  /**
   * ìŒì•…ì—ì„œ ì£¼ ë©œë¡œë”” ì¶”ì¶œ
   * @param {AudioBuffer} musicBuffer
   * @returns {Array<{time: number, pitch: number}>}
   */
  async extractMelody(musicBuffer) {
    await this.initialize();

    const audioData = this.convertToMono(musicBuffer);
    const sampleRate = musicBuffer.sampleRate;

    // Essentiaì˜ PredominantPitchMelodia ì•Œê³ ë¦¬ì¦˜
    const melody = this.essentia.PredominantPitchMelodia(
      audioData,
      {
        frameSize: 2048,
        hopSize: 128,
        sampleRate: sampleRate,
        minFrequency: 80,
        maxFrequency: 2000
      }
    );

    // ì‹œê°„-í”¼ì¹˜ ë°°ì—´ë¡œ ë³€í™˜
    const melodyData = melody.pitch.map((pitch, i) => ({
      time: (i * 128) / sampleRate,
      pitch: pitch,
      confidence: melody.pitchConfidence[i]
    })).filter(p => p.pitch > 0 && p.confidence > 0.8);

    console.log(`âœ“ ë©œë¡œë”” ì¶”ì¶œ ì™„ë£Œ: ${melodyData.length}ê°œ ìŒí‘œ`);
    return melodyData;
  }

  convertToMono(audioBuffer) {
    const channels = audioBuffer.numberOfChannels;
    const length = audioBuffer.length;
    const mono = new Float32Array(length);

    if (channels === 1) {
      return audioBuffer.getChannelData(0);
    }

    for (let i = 0; i < length; i++) {
      let sum = 0;
      for (let ch = 0; ch < channels; ch++) {
        sum += audioBuffer.getChannelData(ch)[i];
      }
      mono[i] = sum / channels;
    }

    return mono;
  }
}
```

### STEP 2.2: ë³´ì´ìŠ¤ ì„¸ê·¸ë¨¼íŠ¸ ë¶„í•  ë° RVC í”¼ì¹˜ ì ìš© (1ì‹œê°„)

```javascript
// engines/VoiceMatcher.js

import { RVCClient } from '../utils/rvcClient';
import * as Tone from 'tone';

export class VoiceMatcher {
  constructor() {
    this.rvcClient = new RVCClient();
  }

  async initialize() {
    await this.rvcClient.initialize();
  }

  /**
   * ë³´ì´ìŠ¤ë¥¼ ë©œë¡œë””ì— ë§ì¶° ë³€í™˜
   * @param {File} voiceFile - ì›ë³¸ ë³´ì´ìŠ¤ íŒŒì¼
   * @param {Array} melodyData - ìŒì•… ë©œë¡œë”” ë°ì´í„°
   * @param {number} musicDuration - ìŒì•… ì „ì²´ ê¸¸ì´
   * @returns {Promise<AudioBuffer>}
   */
  async matchVoiceToMelody(voiceFile, melodyData, musicDuration) {
    await this.initialize();

    // 1. ë³´ì´ìŠ¤ ë¡œë“œ
    const voiceBuffer = await this.loadAudioFile(voiceFile);
    const voiceDuration = voiceBuffer.duration;

    // 2. ë³´ì´ìŠ¤ê°€ ì§§ìœ¼ë©´ ë°˜ë³µ
    const repeatedVoice = this.repeatVoiceIfNeeded(
      voiceBuffer, 
      voiceDuration, 
      musicDuration
    );

    // 3. ë©œë¡œë””ì— ë”°ë¼ í”¼ì¹˜ë³„ë¡œ ì„¸ê·¸ë¨¼íŠ¸ ë¶„í• 
    const segments = this.createSegmentsByPitch(
      repeatedVoice, 
      melodyData
    );

    // 4. ê° ì„¸ê·¸ë¨¼íŠ¸ë¥¼ RVCë¡œ ë³€í™˜
    const processedSegments = await this.processSegmentsWithRVC(
      segments, 
      melodyData
    );

    // 5. ìµœì¢… ì˜¤ë””ì˜¤ í•©ì„±
    return this.concatenateSegments(processedSegments);
  }

  /**
   * ë³´ì´ìŠ¤ ë°˜ë³µ
   */
  repeatVoiceIfNeeded(voiceBuffer, voiceDuration, musicDuration) {
    if (voiceDuration >= musicDuration) {
      return voiceBuffer;
    }

    const repeats = Math.ceil(musicDuration / voiceDuration);
    const audioContext = new AudioContext();
    const totalSamples = Math.ceil(
      musicDuration * voiceBuffer.sampleRate
    );

    const repeatedBuffer = audioContext.createBuffer(
      1,
      totalSamples,
      voiceBuffer.sampleRate
    );

    const outputData = repeatedBuffer.getChannelData(0);
    const sourceData = voiceBuffer.getChannelData(0);

    for (let i = 0; i < repeats; i++) {
      const offset = i * sourceData.length;
      outputData.set(sourceData, offset);
    }

    console.log(`âœ“ ë³´ì´ìŠ¤ ${repeats}íšŒ ë°˜ë³µ ì™„ë£Œ`);
    return repeatedBuffer;
  }

  /**
   * í”¼ì¹˜ë³„ ì„¸ê·¸ë¨¼íŠ¸ ë¶„í• 
   */
  createSegmentsByPitch(voiceBuffer, melodyData) {
    const segments = [];
    const sampleRate = voiceBuffer.sampleRate;
    const audioData = voiceBuffer.getChannelData(0);
    const segmentLength = Math.floor(
      audioData.length / melodyData.length
    );

    for (let i = 0; i < melodyData.length; i++) {
      const start = i * segmentLength;
      const end = Math.min(start + segmentLength, audioData.length);
      
      segments.push({
        data: audioData.slice(start, end),
        targetPitch: melodyData[i].pitch,
        time: melodyData[i].time,
        duration: (end - start) / sampleRate
      });
    }

    return segments;
  }

  /**
   * RVCë¡œ ê° ì„¸ê·¸ë¨¼íŠ¸ ë³€í™˜
   */
  async processSegmentsWithRVC(segments, melodyData) {
    const processed = [];

    for (let i = 0; i < segments.length; i++) {
      const segment = segments[i];
      
      // í”¼ì¹˜ ê³„ì‚°: RVCëŠ” ì„¸ë¯¸í†¤ ë‹¨ìœ„ (-12 ~ +12)
      const basePitch = 200; // ê¸°ë³¸ ìŒì„± í”¼ì¹˜ (Hz)
      const targetPitch = segment.targetPitch;
      const pitchShift = this.calculatePitchShift(basePitch, targetPitch);

      // ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ì„ì‹œ íŒŒì¼ë¡œ ë³€í™˜
      const segmentFile = this.audioDataToFile(
        segment.data, 
        44100, 
        `segment_${i}.wav`
      );

      // RVCë¡œ í”¼ì¹˜ ë³€í™˜
      try {
        const convertedUrl = await this.rvcClient.convertVoice(
          segmentFile,
          {
            pitch: pitchShift,
            indexRate: 0.5,
            protect: 0.33
          }
        );

        // ë³€í™˜ëœ ì˜¤ë””ì˜¤ ë‹¤ìš´ë¡œë“œ
        const convertedData = await this.fetchAudioData(convertedUrl);
        
        processed.push({
          data: convertedData,
          duration: segment.duration
        });

        console.log(`âœ“ ì„¸ê·¸ë¨¼íŠ¸ ${i + 1}/${segments.length} ë³€í™˜ ì™„ë£Œ`);
        
      } catch (error) {
        console.error(`ì„¸ê·¸ë¨¼íŠ¸ ${i} ë³€í™˜ ì‹¤íŒ¨:`, error);
        // ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì‚¬ìš©
        processed.push(segment);
      }

      // API í˜¸ì¶œ ì œí•œ ë°©ì§€ (1ì´ˆ ëŒ€ê¸°)
      await new Promise(resolve => setTimeout(resolve, 1000));
    }

    return processed;
  }

  /**
   * í”¼ì¹˜ ì‹œí”„íŠ¸ ê³„ì‚° (ì„¸ë¯¸í†¤ ë‹¨ìœ„)
   */
  calculatePitchShift(fromPitch, toPitch) {
    const ratio = toPitch / fromPitch;
    const semitones = 12 * Math.log2(ratio);
    return Math.round(semitones);
  }

  /**
   * AudioDataë¥¼ File ê°ì²´ë¡œ ë³€í™˜
   */
  audioDataToFile(audioData, sampleRate, filename) {
    // WAV ì¸ì½”ë”©
    const wavBuffer = this.encodeWAV(audioData, sampleRate);
    const blob = new Blob([wavBuffer], { type: 'audio/wav' });
    return new File([blob], filename, { type: 'audio/wav' });
  }

  /**
   * WAV ì¸ì½”ë”©
   */
  encodeWAV(samples, sampleRate) {
    const buffer = new ArrayBuffer(44 + samples.length * 2);
    const view = new DataView(buffer);

    const writeString = (offset, string) => {
      for (let i = 0; i < string.length; i++) {
        view.setUint8(offset + i, string.charCodeAt(i));
      }
    };

    writeString(0, 'RIFF');
    view.setUint32(4, 36 + samples.length * 2, true);
    writeString(8, 'WAVE');
    writeString(12, 'fmt ');
    view.setUint32(16, 16, true);
    view.setUint16(20, 1, true);
    view.setUint16(22, 1, true);
    view.setUint32(24, sampleRate, true);
    view.setUint32(28, sampleRate * 2, true);
    view.setUint16(32, 2, true);
    view.setUint16(34, 16, true);
    writeString(36, 'data');
    view.setUint32(40, samples.length * 2, true);

    let offset = 44;
    for (let i = 0; i < samples.length; i++) {
      const s = Math.max(-1, Math.min(1, samples[i]));
      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true);
      offset += 2;
    }

    return buffer;
  }

  /**
   * URLì—ì„œ ì˜¤ë””ì˜¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
   */
  async fetchAudioData(url) {
    const response = await fetch(url);
    const arrayBuffer = await response.arrayBuffer();
    const audioContext = new AudioContext();
    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
    return audioBuffer.getChannelData(0);
  }

  async loadAudioFile(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload = async (e) => {
        try {
          const audioContext = new AudioContext();
          const arrayBuffer = e.target.result;
          const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
          resolve(audioBuffer);
        } catch (error) {
          reject(error);
        }
      };
      reader.onerror = reject;
      reader.readAsArrayBuffer(file);
    });
  }

  /**
   * ì„¸ê·¸ë¨¼íŠ¸ í•©ì¹˜ê¸°
   */
  concatenateSegments(segments) {
    const totalSamples = segments.reduce(
      (sum, seg) => sum + seg.data.length,
      0
    );

    const audioContext = new AudioContext();
    const outputBuffer = audioContext.createBuffer(
      1,
      totalSamples,
      44100
    );

    const outputData = outputBuffer.getChannelData(0);
    let offset = 0;

    for (const segment of segments) {
      outputData.set(segment.data, offset);
      offset += segment.data.length;
    }

    return outputBuffer;
  }
}
```

---

## PHASE 3: UI êµ¬ì¶• (2ì‹œê°„)

### STEP 3.1: ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸ (1ì‹œê°„)

```jsx
// App.jsx

import React, { useState } from 'react';
import FileUploader from './components/FileUploader';
import ProcessingStatus from './components/ProcessingStatus';
import AudioPlayer from './components/AudioPlayer';
import { MusicAnalyzer } from './engines/MusicAnalyzer';
import { VoiceMatcher } from './engines/VoiceMatcher';

export default function App() {
  const [musicFile, setMusicFile] = useState(null);
  const [voiceFile, setVoiceFile] = useState(null);
  const [isProcessing, setIsProcessing] = useState(false);
  const [progress, setProgress] = useState({ step: '', percent: 0 });
  const [resultAudio, setResultAudio] = useState(null);
  const [error, setError] = useState(null);

  const handleProcess = async () => {
    if (!musicFile || !voiceFile) {
      setError('ìŒì•…ê³¼ ë³´ì´ìŠ¤ íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”');
      return;
    }

    setIsProcessing(true);
    setProgress({ step: 'ì´ˆê¸°í™” ì¤‘...', percent: 0 });
    setError(null);

    try {
      // 1. ìŒì•… ë¶„ì„
      setProgress({ step: 'ğŸ¼ ìŒì•… ë©œë¡œë”” ë¶„ì„ ì¤‘...', percent: 20 });
      const analyzer = new MusicAnalyzer();
      await analyzer.initialize();
      
      const musicBuffer = await loadAudioFile(musicFile);
      const melodyData = await analyzer.extractMelody(musicBuffer);

      // 2. ë³´ì´ìŠ¤ ë³€í™˜
      setProgress({ step: 'ğŸ¤ ë³´ì´ìŠ¤ ë³€í™˜ ì¤‘... (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)', percent: 40 });
      const matcher = new VoiceMatcher();
      await matcher.initialize();

      const result = await matcher.matchVoiceToMelody(
        voiceFile,
        melodyData,
        musicBuffer.duration
      );

      // 3. ì™„ë£Œ
      setProgress({ step: 'âœ… ì™„ë£Œ!', percent: 100 });
      setResultAudio(result);

    } catch (err) {
      console.error('ì²˜ë¦¬ ì‹¤íŒ¨:', err);
      setError(err.message);
    } finally {
      setIsProcessing(false);
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-red-900 p-8">
      <div className="max-w-5xl mx-auto">
        {/* í—¤ë” */}
        <div className="text-center mb-12">
          <h1 className="text-6xl font-bold text-white mb-4">
            ğŸµ PitchMixer
          </h1>
          <p className="text-xl text-purple-200">
            AIê°€ ë‹¹ì‹ ì˜ ëª©ì†Œë¦¬ë¥¼ ìŒì•…ì— ì™„ë²½í•˜ê²Œ ì…í™ë‹ˆë‹¤
          </p>
          <p className="text-sm text-purple-300 mt-2">
            Powered by RVC AI - 100% ë¬´ë£Œ
          </p>
        </div>

        {/* íŒŒì¼ ì—…ë¡œë“œ */}
        <div className="grid md:grid-cols-2 gap-6 mb-8">
          <FileUploader
            label="ğŸ¼ ìŒì•… íŒŒì¼"
            accept="audio/*"
            onFileSelect={setMusicFile}
            file={musicFile}
            icon="ğŸµ"
          />

          <FileUploader
            label="ğŸ¤ ë³´ì´ìŠ¤ ìƒ˜í”Œ"
            accept="audio/*"
            onFileSelect={setVoiceFile}
            file={voiceFile}
            icon="ğŸ™ï¸"
          />
        </div>

        {/* ì‹¤í–‰ ë²„íŠ¼ */}
        <button
          onClick={handleProcess}
          disabled={isProcessing || !musicFile || !voiceFile}
          className="w-full bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 
                   text-white font-bold py-6 px-8 rounded-xl text-2xl
                   hover:from-pink-600 hover:via-purple-600 hover:to-indigo-600 
                   disabled:opacity-50 disabled:cursor-not-allowed
                   transition-all duration-300 shadow-2xl hover:shadow-pink-500/50
                   transform hover:scale-105 disabled:hover:scale-100"
        >
          {isProcessing ? 'ğŸ”„ ì²˜ë¦¬ ì¤‘...' : 'âœ¨ PitchMix ì‹œì‘!'}
        </button>

        {/* ì§„í–‰ ìƒíƒœ */}
        {isProcessing && (
          <ProcessingStatus 
            step={progress.step} 
            percent={progress.percent} 
          />
        )}

        {/* ì—ëŸ¬ */}
        {error && (
          <div className="mt-8 bg-red-500/20 border-2 border-red-500 rounded-xl p-6">
            <p className="text-red-200 text-lg">âŒ {error}</p>
          </div>
        )}

        {/* ê²°ê³¼ */}
        {resultAudio && (
          <AudioPlayer audioBuffer={resultAudio} />
        )}

        {/* ì•ˆë‚´ */}
        <div className="mt-12 bg-white/10 backdrop-blur-md rounded-xl p-6">
          <h3 className="text-white text-lg font-bold mb-3">ğŸ’¡ ì‚¬ìš© íŒ</h3>
          <ul className="text-purple-200 space-y-2">
            <li>â€¢ ìŒì•…ì€ ëª…í™•í•œ ë©œë¡œë””ê°€ ìˆëŠ” ê³¡ì´ ì¢‹ìŠµë‹ˆë‹¤</li>
            <li>â€¢ ë³´ì´ìŠ¤ëŠ” 2-10ì´ˆ ì •ë„ê°€ ì ë‹¹í•©ë‹ˆë‹¤</li>
            <li>â€¢ ì²˜ë¦¬ ì‹œê°„: ì•½ 3-5ë¶„ (ë¬´ë£Œ ì„œë¹„ìŠ¤ ì‚¬ìš© ì‹œ)</li>
            <li>â€¢ RVC AIê°€ ìë™ìœ¼ë¡œ ìµœì ì˜ í”¼ì¹˜ë¥¼ ì°¾ì•„ì¤ë‹ˆë‹¤</li>
          </ul>
        </div>
      </div>
    </div>
  );
}

// í—¬í¼ í•¨ìˆ˜
async function loadAudioFile(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = async (e) => {
      try {
        const audioContext = new AudioContext();
        const arrayBuffer = e.target.result;
        const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
        resolve(audioBuffer);
      } catch (error) {
        reject(error);
      }
    };
    reader.onerror = reject;
    reader.readAsArrayBuffer(file);
  });
}
```

### STEP 3.2: UI ì„œë¸Œ ì»´í¬ë„ŒíŠ¸ (1ì‹œê°„)

```jsx
// components/FileUploader.jsx

import React, { useState } from 'react';

export default function FileUploader({ label, accept, onFileSelect, file, icon }) {
  const [isDragging, setIsDragging] = useState(false);

  const handleDrop = (e) => {
    e.preventDefault();
    setIsDragging(false);
    
    const droppedFile = e.dataTransfer.files[0];
    if (droppedFile && droppedFile.type.startsWith('audio/')) {
      onFileSelect(droppedFile);
    }
  };

  const handleChange = (e) => {
    const selectedFile = e.target.files[0];
    if (selectedFile) {
      onFileSelect(selectedFile);
    }
  };

  return (
    <div
      onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
      onDragLeave={() => setIsDragging(false)}
      onDrop={handleDrop}
      className={`bg-white/10 backdrop-blur-md rounded-xl p-8 border-2 border-dashed
                  transition-all duration-300 cursor-pointer hover:bg-white/20
                  ${isDragging ? 'border-pink-400 bg-pink-500/20 scale-105' : 'border-purple-400'}`}
    >
      <label className="cursor-pointer block">
        <div className="text-center">
          <div className="text-6xl mb-4">{icon}</div>
          <h3 className="text-white text-xl font-bold mb-2">{label}</h3>
          
          {file ? (
            <div className="bg-green-500/20 rounded-lg p-4 mt-4">
              <p className="text-green-300 font-semibold">âœ“ {file.name}</p>
              <p className="text-green-400 text-sm mt-1">
                {(file.size / 1024 / 1024).toFixed(2)} MB
              </p>
            </div>
          ) : (
            <p className="text-purple-300">
              íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ
            </p>
          )}
          
          <input
            type="file"
            accept={accept}
            onChange={handleChange}
            className="hidden"
          />
        </div>
      </label>
    </div>
  );
}
```

```jsx
// components/ProcessingStatus.jsx

import React from 'react';

export default function ProcessingStatus({ step, percent }) {
  return (
    <div className="mt-8 bg-white/10 backdrop-blur-md rounded-xl p-6">
      <div className="flex items-center justify-between mb-4">
        <h3 className="text-white text-xl font-bold">{step}</h3>
        <span className="text-purple-300 text-lg font-semibold">
          {percent}%
        </span>
      </div>

      <div className="w-full bg-gray-700 rounded-full h-6 overflow-hidden">
        <div
          className="h-full bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 
                     transition-all duration-500 ease-out flex items-center justify-center"
          ````jsx
          style={{ width: `${percent}%` }}
          ````
        >
          {percent > 10 && (
            <span className="text-white text-xs font-bold">
              {percent}%
            </span>
          )}
        </div>
      </div>

      <div className="mt-4 flex items-center justify-center space-x-2">
        <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
        <p className="text-purple-200 text-sm">
          ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”... RVC AIê°€ ì‘ì—… ì¤‘ì…ë‹ˆë‹¤
        </p>
      </div>
    </div>
  );
}
```

```jsx
// components/AudioPlayer.jsx

import React, { useState, useRef, useEffect } from 'react';
import * as Tone from 'tone';

export default function AudioPlayer({ audioBuffer }) {
  const [isPlaying, setIsPlaying] = useState(false);
  const [currentTime, setCurrentTime] = useState(0);
  const playerRef = useRef(null);
  const duration = audioBuffer.duration;

  useEffect(() => {
    const toneBuffer = new Tone.ToneAudioBuffer();
    toneBuffer.set(audioBuffer);
    playerRef.current = new Tone.Player(toneBuffer).toDestination();

    // ì¬ìƒ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    const interval = setInterval(() => {
      if (isPlaying && playerRef.current) {
        setCurrentTime(prev => Math.min(prev + 0.1, duration));
      }
    }, 100);

    return () => {
      clearInterval(interval);
      if (playerRef.current) {
        playerRef.current.dispose();
      }
    };
  }, [audioBuffer, duration, isPlaying]);

  const handlePlay = async () => {
    if (!playerRef.current) return;

    if (isPlaying) {
      playerRef.current.stop();
      setIsPlaying(false);
    } else {
      await Tone.start();
      playerRef.current.start();
      setIsPlaying(true);
      setCurrentTime(0);
    }
  };

  const handleDownload = () => {
    const wav = audioBufferToWav(audioBuffer);
    const blob = new Blob([wav], { type: 'audio/wav' });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = `pitchmixer_${Date.now()}.wav`;
    a.click();
    
    URL.revokeObjectURL(url);
  };

  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  };

  return (
    <div className="mt-8 bg-gradient-to-r from-green-500/20 to-blue-500/20 backdrop-blur-md 
                    rounded-xl p-8 border-2 border-green-400">
      <h3 className="text-white text-2xl font-bold mb-6 text-center">
        ğŸ‰ ë³€í™˜ ì™„ë£Œ!
      </h3>

      {/* ì¬ìƒ ë°” */}
      <div className="mb-6">
        <div className="w-full bg-gray-700 rounded-full h-3 mb-2">
          <div
            className="bg-gradient-to-r from-green-400 to-blue-500 h-3 rounded-full transition-all"
            style={{ width: `${(currentTime / duration) * 100}%` }}
          />
        </div>
        <div className="flex justify-between text-purple-200 text-sm">
          <span>{formatTime(currentTime)}</span>
          <span>{formatTime(duration)}</span>
        </div>
      </div>

      {/* ì»¨íŠ¸ë¡¤ ë²„íŠ¼ */}
      <div className="flex gap-4">
        <button
          onClick={handlePlay}
          className="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 
                   hover:from-green-600 hover:to-emerald-600 
                   text-white font-bold py-4 px-6 rounded-lg text-lg
                   transition-all duration-300 shadow-lg hover:shadow-green-500/50
                   transform hover:scale-105"
        >
          {isPlaying ? 'â¸ ì¼ì‹œì •ì§€' : 'â–¶ ì¬ìƒ'}
        </button>
        
        <button
          onClick={handleDownload}
          className="flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 
                   hover:from-blue-600 hover:to-cyan-600 
                   text-white font-bold py-4 px-6 rounded-lg text-lg
                   transition-all duration-300 shadow-lg hover:shadow-blue-500/50
                   transform hover:scale-105"
        >
          ğŸ’¾ ë‹¤ìš´ë¡œë“œ
        </button>
      </div>

      <p className="text-center text-purple-200 text-sm mt-4">
        ê²°ê³¼ê°€ ë§ˆìŒì— ë“œì‹œë‚˜ìš”? ë‹¤ë¥¸ ì„¤ì •ìœ¼ë¡œë„ ì‹œë„í•´ë³´ì„¸ìš”!
      </p>
    </div>
  );
}

// WAV ì¸ì½”ë”© í—¬í¼
function audioBufferToWav(audioBuffer) {
  const numChannels = audioBuffer.numberOfChannels;
  const sampleRate = audioBuffer.sampleRate;
  const format = 1;
  const bitDepth = 16;

  const bytesPerSample = bitDepth / 8;
  const blockAlign = numChannels * bytesPerSample;

  const data = new Float32Array(audioBuffer.length * numChannels);
  for (let i = 0; i < numChannels; i++) {
    const channel = audioBuffer.getChannelData(i);
    for (let j = 0; j < audioBuffer.length; j++) {
      data[j * numChannels + i] = channel[j];
    }
  }

  const dataLength = data.length * bytesPerSample;
  const buffer = new ArrayBuffer(44 + dataLength);
  const view = new DataView(buffer);

  const writeString = (offset, string) => {
    for (let i = 0; i < string.length; i++) {
      view.setUint8(offset + i, string.charCodeAt(i));
    }
  };

  writeString(0, 'RIFF');
  view.setUint32(4, 36 + dataLength, true);
  writeString(8, 'WAVE');
  writeString(12, 'fmt ');
  view.setUint32(16, 16, true);
  view.setUint16(20, format, true);
  view.setUint16(22, numChannels, true);
  view.setUint32(24, sampleRate, true);
  view.setUint32(28, sampleRate * blockAlign, true);
  view.setUint16(32, blockAlign, true);
  view.setUint16(34, bitDepth, true);
  writeString(36, 'data');
  view.setUint32(40, dataLength, true);

  let offset = 44;
  for (let i = 0; i < data.length; i++) {
    const sample = Math.max(-1, Math.min(1, data[i]));
    view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
    offset += 2;
  }

  return buffer;
}
```

---

## PHASE 4: ìµœì í™” ë° í…ŒìŠ¤íŠ¸ (1ì‹œê°„)

### STEP 4.1: API í˜¸ì¶œ ìµœì í™”

```javascript
// utils/apiOptimizer.js

/**
 * RVC API í˜¸ì¶œ ìµœì í™” ê´€ë¦¬ì
 */
export class APIOptimizer {
  constructor() {
    this.queue = [];
    this.isProcessing = false;
    this.maxRetries = 3;
    this.retryDelay = 2000;
  }

  /**
   * API í˜¸ì¶œì„ íì— ì¶”ê°€
   */
  async enqueue(apiCall) {
    return new Promise((resolve, reject) => {
      this.queue.push({ apiCall, resolve, reject, retries: 0 });
      this.processQueue();
    });
  }

  /**
   * í ì²˜ë¦¬
   */
  async processQueue() {
    if (this.isProcessing || this.queue.length === 0) return;

    this.isProcessing = true;
    const item = this.queue.shift();

    try {
      const result = await item.apiCall();
      item.resolve(result);
    } catch (error) {
      // ì¬ì‹œë„ ë¡œì§
      if (item.retries < this.maxRetries) {
        item.retries++;
        console.warn(`ì¬ì‹œë„ ${item.retries}/${this.maxRetries}...`);
        
        await new Promise(resolve => 
          setTimeout(resolve, this.retryDelay)
        );
        
        this.queue.unshift(item);
      } else {
        item.reject(error);
      }
    } finally {
      this.isProcessing = false;
      
      // ë‹¤ìŒ í•­ëª© ì²˜ë¦¬ (1ì´ˆ ëŒ€ê¸°)
      if (this.queue.length > 0) {
        setTimeout(() => this.processQueue(), 1000);
      }
    }
  }
}

// ì‚¬ìš© ì˜ˆì‹œ
const optimizer = new APIOptimizer();

async function convertWithRetry(rvcClient, file, options) {
  return optimizer.enqueue(() => 
    rvcClient.convertVoice(file, options)
  );
}
```

### STEP 4.2: ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”

```javascript
// utils/errorHandler.js

export class PitchMixerError extends Error {
  constructor(message, code, details) {
    super(message);
    this.name = 'PitchMixerError';
    this.code = code;
    this.details = details;
  }
}

export const ErrorCodes = {
  FILE_LOAD_ERROR: 'FILE_LOAD_ERROR',
  API_CONNECTION_ERROR: 'API_CONNECTION_ERROR',
  PITCH_ANALYSIS_ERROR: 'PITCH_ANALYSIS_ERROR',
  VOICE_CONVERSION_ERROR: 'VOICE_CONVERSION_ERROR',
  AUDIO_PROCESSING_ERROR: 'AUDIO_PROCESSING_ERROR'
};

export function handleError(error) {
  console.error('PitchMixer Error:', error);

  let userMessage = 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';

  if (error instanceof PitchMixerError) {
    switch (error.code) {
      case ErrorCodes.FILE_LOAD_ERROR:
        userMessage = 'íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì˜¬ë°”ë¥¸ ì˜¤ë””ì˜¤ íŒŒì¼ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.';
        break;
      case ErrorCodes.API_CONNECTION_ERROR:
        userMessage = 'RVC ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.';
        break;
      case ErrorCodes.PITCH_ANALYSIS_ERROR:
        userMessage = 'ìŒì•… ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ëª…í™•í•œ ë©œë¡œë””ê°€ ìˆëŠ” ê³¡ìœ¼ë¡œ ì‹œë„í•´ì£¼ì„¸ìš”.';
        break;
      case ErrorCodes.VOICE_CONVERSION_ERROR:
        userMessage = 'ìŒì„± ë³€í™˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
        break;
      default:
        userMessage = error.message;
    }
  }

  return userMessage;
}
```

### STEP 4.3: í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

```markdown
## ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

### íŒŒì¼ ì—…ë¡œë“œ
- [ ] MP3 íŒŒì¼ (5MB ì´í•˜)
- [ ] WAV íŒŒì¼ (10MB ì´í•˜)
- [ ] ê¸´ ìŒì•… íŒŒì¼ (3ë¶„ ì´ìƒ)
- [ ] ì§§ì€ ë³´ì´ìŠ¤ (2-5ì´ˆ)
- [ ] ë“œë˜ê·¸ ì•¤ ë“œë¡­

### RVC API ì—°ê²°
- [ ] ì´ˆê¸°í™” ì„±ê³µ
- [ ] ëª¨ë¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
- [ ] ìƒ˜í”Œ ë³€í™˜ í…ŒìŠ¤íŠ¸
- [ ] ì—ëŸ¬ í•¸ë“¤ë§ (íƒ€ì„ì•„ì›ƒ, ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜)
- [ ] ì¬ì‹œë„ ë¡œì§

### í”¼ì¹˜ ë§¤ì¹­
- [ ] ë‹¨ìˆœ ë©œë¡œë”” (ë™ìš”, ë¯¼ìš”)
- [ ] ë³µì¡í•œ ë©œë¡œë”” (íŒì†¡)
- [ ] ë¹ ë¥¸ í…œí¬ ê³¡
- [ ] ëŠë¦° í…œí¬ ê³¡
- [ ] ë³´ì´ìŠ¤ ë°˜ë³µ ê¸°ëŠ¥

### ìµœì¢… ì¶œë ¥
- [ ] ì¬ìƒ ê°€ëŠ¥
- [ ] ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
- [ ] WAV íŒŒì¼ í’ˆì§ˆ í™•ì¸
- [ ] íŒŒì¼ í¬ê¸° ì ì ˆ (< 50MB)

### ì„±ëŠ¥
- [ ] ì „ì²´ ì²˜ë¦¬ ì‹œê°„ (< 5ë¶„)
- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
- [ ] ë¸Œë¼ìš°ì € í˜¸í™˜ì„± (Chrome, Firefox)
```

---

## ğŸ“Š ì˜ˆìƒ ê°œë°œ ì‹œê°„ ë° ì¼ì •

| Phase | ì‘ì—… ë‚´ìš© | ì‹œê°„ | ëˆ„ì  |
|-------|----------|------|------|
| Phase 1 | RVC API ì—°ë™ | 2ì‹œê°„ | 2ì‹œê°„ |
| Phase 2 | í”¼ì¹˜ ë§¤ì¹­ ì—”ì§„ | 2ì‹œê°„ | 4ì‹œê°„ |
| Phase 3 | UI êµ¬ì¶• | 2ì‹œê°„ | 6ì‹œê°„ |
| Phase 4 | ìµœì í™” & í…ŒìŠ¤íŠ¸ | 1ì‹œê°„ | 7ì‹œê°„ |

**ì´ ê°œë°œ ì‹œê°„: ì•½ 7ì‹œê°„ (1ì¼ ì‘ì—…)**

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­ ë° ì œí•œì‚¬í•­

### Hugging Face Spaces ë¬´ë£Œ í‹°ì–´ ì œí•œ
1. **ì²˜ë¦¬ ì‹œê°„**: ì„¸ê·¸ë¨¼íŠ¸ë‹¹ ì•½ 10-30ì´ˆ
2. **í ëŒ€ê¸°**: ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë§ìœ¼ë©´ ëŒ€ê¸° ì‹œê°„ ì¦ê°€
3. **ë™ì‹œ ìš”ì²­ ì œí•œ**: í•œ ë²ˆì— 1-2ê°œ ìš”ì²­ë§Œ ê°€ëŠ¥
4. **íƒ€ì„ì•„ì›ƒ**: 5ë¶„ ì´ìƒ ì‘ë‹µ ì—†ìœ¼ë©´ ì¬ì‹œë„

### í•´ê²° ë°©ë²•
```javascript
// ë³‘ë ¬ ì²˜ë¦¬ ëŒ€ì‹  ìˆœì°¨ ì²˜ë¦¬
async function processSegmentsSequentially(segments) {
  const results = [];
  
  for (let i = 0; i < segments.length; i++) {
    console.log(`ì²˜ë¦¬ ì¤‘: ${i + 1}/${segments.length}`);
    
    const result = await processSegmentWithRetry(segments[i]);
    results.push(result);
    
    // API ê³¼ë¶€í•˜ ë°©ì§€ (1ì´ˆ ëŒ€ê¸°)
    await delay(1000);
  }
  
  return results;
}
```

### ìŒì§ˆ ê³ ë ¤ì‚¬í•­
1. **ì…ë ¥ í’ˆì§ˆ**: ë†’ì€ í’ˆì§ˆì˜ ì˜¤ë””ì˜¤ íŒŒì¼ ì‚¬ìš© (44.1kHz ì´ìƒ)
2. **ë³´ì´ìŠ¤ ê¸¸ì´**: ë„ˆë¬´ ì§§ìœ¼ë©´ (<1ì´ˆ) í’ˆì§ˆ ì €í•˜ ê°€ëŠ¥
3. **í”¼ì¹˜ ë²”ìœ„**: ê·¹ë‹¨ì ì¸ í”¼ì¹˜ ë³€í™˜ (Â±12 ì„¸ë¯¸í†¤ ì´ˆê³¼) ì‹œ ì™œê³¡ ê°€ëŠ¥

---

## ğŸ¯ Phase 2ë¡œ í™•ì¥ ê³„íš

### ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥

1. **ë³´ì»¬ ë¶„ë¦¬ í†µí•©**
   - Demucs API ì¶”ê°€
   - ë°°ê²½ìŒê³¼ ë³´ì»¬ ë¶„ë¦¬ ì²˜ë¦¬
   - ì˜ˆìƒ ì¶”ê°€ ì‹œê°„: 3ì‹œê°„

2. **ë‹¤ì¤‘ ë³´ì´ìŠ¤ ë ˆì´ì–´**
   - ì—¬ëŸ¬ ë³´ì´ìŠ¤ ë™ì‹œ ë³€í™˜
   - í•˜ëª¨ë‹ˆ ìƒì„±
   - ì˜ˆìƒ ì¶”ê°€ ì‹œê°„: 2ì‹œê°„

3. **ì‹¤ì‹œê°„ í”„ë¦¬ë·°**
   - ë³€í™˜ ì „ ë¯¸ë¦¬ë“£ê¸°
   - íŒŒë¼ë¯¸í„° ì¡°ì •
   - ì˜ˆìƒ ì¶”ê°€ ì‹œê°„: 2ì‹œê°„

4. **í”„ë¦¬ì…‹ ì €ì¥**
   - ìì£¼ ì“°ëŠ” ì„¤ì • ì €ì¥
   - ê³µìœ  ê¸°ëŠ¥
   - ì˜ˆìƒ ì¶”ê°€ ì‹œê°„: 1ì‹œê°„

---

## âœ… ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ê°œë°œ ì™„ë£Œ ê¸°ì¤€
- [ ] RVC API ì •ìƒ ì‘ë™
- [ ] íŒŒì¼ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
- [ ] í”¼ì¹˜ ë§¤ì¹­ ì •í™•ë„ 80% ì´ìƒ
- [ ] ì—ëŸ¬ í•¸ë“¤ë§ ì™„ë£Œ
- [ ] ëª¨ë°”ì¼ ë°˜ì‘í˜• UI
- [ ] í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸ ì™„ë£Œ

### ë°°í¬ ì¤€ë¹„
- [ ] Antigravity ì•„í‹°íŒ©íŠ¸ ìƒì„±
- [ ] README ì‘ì„±
- [ ] ì‚¬ìš© ê°€ì´ë“œ ì˜ìƒ/ë¬¸ì„œ
- [ ] í…ŒìŠ¤íŠ¸ ê³„ì • ìƒ˜í”Œ íŒŒì¼ ì¤€ë¹„

---

## ğŸ’¡ ì„±ê³µì„ ìœ„í•œ íŒ

1. **ë¨¼ì € ì‘ì€ íŒŒì¼ë¡œ í…ŒìŠ¤íŠ¸**
   - 10ì´ˆ ìŒì•… + 2ì´ˆ ë³´ì´ìŠ¤ë¡œ í”„ë¡œí† íƒ€ì… ê²€ì¦
   
2. **API ì‘ë‹µ ì‹œê°„ ê³ ë ¤**
   - ì‚¬ìš©ìì—ê²Œ "3-5ë¶„ ì†Œìš”" ëª…í™•íˆ ì•ˆë‚´
   - ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì§€ë£¨í•¨ ë°©ì§€

3. **ìƒ˜í”Œ ì œê³µ**
   - í…ŒìŠ¤íŠ¸ìš© ìŒì•…/ë³´ì´ìŠ¤ ìƒ˜í”Œ ë¯¸ë¦¬ ì¤€ë¹„
   - "ìƒ˜í”Œë¡œ ì‹œë„í•´ë³´ê¸°" ë²„íŠ¼ ì¶”ê°€

4. **í”¼ë“œë°± ìˆ˜ì§‘**
   - ì‚¬ìš©ì ë§Œì¡±ë„ ì¡°ì‚¬
   - ë²„ê·¸ ë¦¬í¬íŠ¸ ì‹œìŠ¤í…œ

---

**ì´ ê³„íšì„œëŒ€ë¡œ ì§„í–‰í•˜ë©´ ì™„ì „ ë¬´ë£Œë¡œ PitchMixerë¥¼ ì™„ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!** ğŸš€

ë°”ë¡œ ì‹œì‘í•˜ì‹œê² ì–´ìš”? Phase 1ë¶€í„° í•¨ê»˜ ê°œë°œí•´ë³¼ê¹Œìš”? ğŸ˜Š
